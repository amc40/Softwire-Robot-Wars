<!DOCTYPE html>

<head>
    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"
        integrity="sha384-7EyYLQZgWBi67fBtVxw60/OWl1kjsfrPFcaU0pp0nAh+i8FD068QogUvg85Ewy1k"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../styles.css">
    <style type="text/css" media="screen">
        #editor {
            width: 700px;
            height: 700px;
        }
    </style>
    <script>

        const socket = io.connect("ws://localhost:3001");
        socket.on('welcome', function (data) {
            console.log("welcome message received")
            // Respond with a message including this clients' id sent from the server

        });

        function startBattle() {
            socket.emit('startBattle');
            console.log("emit start battle");
            socket.on('gameState', function (data) {
                console.log(data);
            });
        }

        function doUpload() {
            userCode = editor.getValue().replace(/\n/g, '');;
            nameInput = document.getElementById("name").value;
            socket.emit('uploadRobot', { name: nameInput, colour: "RED", robotCode: userCode });
        }

    </script>
</head>

<body>

    <div class="container">
        <div class="header danger"></div>
        <div class="content">
            <p class="title">Upload Page</p>

            <a href="../main.html">networking page</a>
            <br>
            <a href="../demo.html">demo page</a>
            <br><br>

        </div>
        <div class="content">

            <label for="name">Name</label>
            <input type="type" id="name"><br><br>
        </div>
        <div class="content">
            <div id="editor">function foo(items) {
                var x = "All this is syntax highlighted";
                return x;
                }
            </div>

            <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.11.0/ace.js" type="text/javascript"
                charset="utf-8"></script>
            <script>
                var editor = ace.edit("editor");
                editor.setTheme("ace/theme/monokai");
                editor.session.setMode("ace/mode/javascript");
            </script>
            <br>
        </div>
        <div class="content">
            <input type="submit" value="Upload" onclick="doUpload();return false">

            <input type="submit" value="Start Battle!" onclick="startBattle();return false">
        </div>
        <div class="footer danger"></div>
    </div>


</body>